package bartMachine;

import gnu.trove.list.array.TDoubleArrayList;

import java.util.ArrayList;

import org.apache.commons.math.MathException;
import org.apache.commons.math.distribution.ChiSquaredDistributionImpl;

/**
 * This portion of the code controls hyperparameters for the BART
 * algorithm as well as properties and transformations of the response variable.
 * 
 * @author Adam Kapelner and Justin Bleich
 */
public abstract class bartMachine_b_hyperparams extends bartMachine_a_base {

	/** The static field that controls the bounds on the transformed y variable which is between negative and positive this value */
	protected static final double YminAndYmaxHalfDiff = 0.5;
	
	/** A cached library of chi-squared with degrees of freedom nu plus n (used for Gibbs sampling the variance) */
	protected static double[] samps_chi_sq_df_eq_nu_plus_n = {91.5500299704091, 122.930580590512, 97.2981093727447, 110.188937033023, 107.62419643646, 93.6300309735017, 84.6918282478283, 107.162614686045, 112.878113931898, 95.7540954424363, 106.991145772819, 91.9205853964432, 90.5576255337813, 111.586572399298, 97.1678490650026, 141.924110747192, 96.0245641905727, 103.418861554784, 126.359310571339, 104.575517049438, 71.9705886002757, 87.5651275816593, 90.7162868450617, 115.806451793319, 92.8437529639622, 104.417758671362, 115.128754100794, 90.3019497194863, 107.9727008723, 103.128778074232, 93.9651384903729, 91.574659959394, 111.66055644884, 97.1549683726791, 140.39675498985, 106.795753798796, 105.238246868311, 89.8460277267267, 116.818766231565, 132.218250776829, 113.058727429134, 122.444693938588, 94.0274541745456, 110.825479372008, 105.852724368387, 108.516064776537, 90.0113388633385, 118.87218960843, 143.684631199289, 122.020840985398, 116.240929603437, 78.865942858436, 97.8447731141256, 99.3650957852533, 108.020157112977, 103.370921577144, 101.553617068451, 94.8206762694726, 107.10026938104, 103.683628266971, 106.467910281612, 100.469755875261, 87.327107531556, 108.166258311256, 113.070202017045, 102.236509364414, 115.673558466395, 107.94711800756, 100.304222209233, 95.446265116438, 106.125809402711, 85.3999813496248, 92.4715260717632, 126.62500241671, 94.3263312994142, 87.6343309575512, 108.648679446477, 113.354308100277, 101.657175165721, 105.891228792118, 105.248215173109, 115.872014117404, 134.99986982066, 96.4332492300795, 113.070491706404, 99.8040864199546, 89.6669735553627, 93.5580007893894, 107.999082107136, 82.8796571462151, 114.423986599064, 91.0356176108012, 119.1849626302, 85.069982998888, 97.060058510895, 101.452795600532, 96.9068201912791, 85.4141252306274, 104.892308258913, 102.378391671724, 109.903069517001, 98.6629546311029, 110.10182766525, 86.5486841209584, 101.226110713664, 108.658400206234, 100.290154427629, 108.832394773574, 83.8284169499912, 113.872161757766, 124.375015991482, 84.7250881473892, 119.418559967325, 82.1078601914049, 72.6644396981133, 94.329671737535, 99.7848629082239, 110.586713407043, 105.832615959906, 117.468864419535, 110.954118479055, 98.0315621170578, 119.570049519453, 102.48706194483, 107.725436067694, 96.8087153930722, 116.20311330187, 100.204853061116, 107.189692240297, 91.5007926856273, 112.759033990877, 101.521561158849, 100.644165997241, 118.176824360728, 105.015431514209, 100.294728192917, 87.9470368712953, 97.0479194182632, 85.8584640183249, 90.0135837093095, 126.353127369267, 99.894072129481, 101.359488892891, 123.931232476117, 106.722507171239, 115.500152825668, 108.29174750502, 126.396379327133, 104.512832635459, 78.4959855434642, 114.889239020845, 107.708042605183, 94.2115068624387, 99.5183816500061, 83.431608725969, 113.698131709821, 103.405977294778, 94.1559015643758, 103.71456545315, 92.7844627252721, 96.6350786988087, 85.1650445027219, 94.037933135904, 87.2002253852845, 96.8512832798192, 115.331171039465, 90.1586559305472, 97.063056634039, 116.064862255258, 98.9882136076009, 141.231298050321, 77.8772606253644, 89.9713102208677, 115.633008581801, 125.514148525615, 95.9512192949113, 99.993042473728, 62.4074628091716, 83.9119217618536, 119.377215427234, 122.377387899969, 105.561167383593, 95.4199800951809, 112.978429749636, 106.433423794616, 118.258121941855, 97.5780628137911, 123.974234153158, 101.159933947856, 122.131189885087, 107.78500589865, 97.3166766042195, 122.701986582707, 115.397956205242, 78.7775849894497, 95.8475731545423, 114.825091212906, 74.7490764564936, 97.1635013557863, 109.199913864275, 117.34237773144, 106.510171289, 95.662754144266, 100.36606287277, 127.489200650377, 126.834263557895, 101.906410574873, 89.695635717321, 112.795801625371, 115.626232509502, 100.464220418531, 106.328036915317, 104.693983164152, 78.0548569609582, 97.509647737264, 119.734399256896, 76.2920115094399, 78.6145653129244, 98.5138469132548, 116.011737917104, 102.797830105721, 104.401774866002, 93.1525732821747, 95.0468050774922, 113.404841313969, 101.489517944126, 125.336844991498, 93.1455624918784, 106.177987076676, 102.437842519178, 124.358728310163, 110.381280965787, 92.3796533012444, 90.2716458343404, 135.332319881645, 113.098827168948, 129.239331431526, 114.063675481658, 114.871507174363, 120.685269842301, 81.0809886620668, 99.2266923681451, 91.2390021157028, 121.894185649076, 79.3002098839756, 136.030064124587, 113.602473916227, 88.3306832756016, 132.417151808472, 100.671244931913, 98.7252186713505, 95.286262413568, 113.942444093025, 122.889000957361, 91.9716847753802, 96.4295569257197, 87.4178311552562, 104.799034792413, 120.056039686501, 90.4920427010728, 87.8820971348627, 80.7414104022989, 94.1879213894911, 100.105088071456, 86.8311148140305, 116.696606941906, 88.9794676675337, 107.258348152924, 86.175909147487, 92.6698774896464, 111.08304937699, 119.276102218034, 97.1976808863162, 85.3439207876347, 102.881645309884, 110.890575320469, 110.093107576721, 88.8214524432303, 107.210642083185, 106.419316352084, 87.3422234606274, 119.171492204782, 85.237468237748, 111.807670620214, 102.779029347278, 113.412425804044, 114.332826951119, 80.3933722076176, 153.79867793409, 100.118687643647, 89.1587484645766, 102.400678188902, 95.1068247382176, 100.542481119722, 108.991663210263, 78.6555472047084, 99.6359886175415, 108.085892833645, 94.1908607383118, 89.1664584486498, 121.918391539957, 91.1798522276292, 108.566713368788, 125.50317528842, 115.411984825554, 95.3869654785118, 97.448437537683, 91.6080478066607, 97.9596825618557, 104.110603705086, 111.585972019512, 99.8909817049121, 75.8152554532028, 131.235337346068, 83.9083181707556, 83.7499254584885, 109.264777187889, 111.052988176686, 97.6961386038175, 114.241781601577, 103.880939920831, 110.430464921332, 103.335351065571, 107.401061334061, 108.95364000601, 80.8132143596089, 115.171034502282, 84.5408823064549, 113.498606168301, 97.1331321972956, 94.2171481350578, 118.425891233438, 101.916603385225, 108.29877515712, 114.55959011207, 107.006157041093, 106.988423739406, 114.661835790391, 94.7874321881392, 112.010146298338, 112.44108025155, 131.780628684264, 106.611629168346, 109.596023534612, 112.467820263803, 108.651919712837, 111.72368789473, 97.9735699816897, 102.094094498207, 104.432499594183, 105.041712600188, 111.432640231639, 100.506039234471, 95.5664476310119, 104.826046396835, 111.521625792459, 86.7193199994615, 104.645380687267, 102.025959271342, 115.180091937624, 97.9948757591635, 110.483303540967, 74.0137778289543, 90.1318923739783, 93.0784005660891, 106.585374195408, 98.7053868776767, 92.1986884308983, 98.992829414529, 115.513272919148, 124.013652698173, 108.463849301236, 78.1741029611473, 111.932526356535, 108.948361760653, 104.394863048387, 98.7579675197971, 108.329134069103, 89.5266122507722, 86.7019145497366, 96.8184807051204, 102.189475480151, 120.941775584952, 89.0365083214834, 84.0072671247124, 120.872248536387, 95.4695294105093, 95.4522444475991, 94.0857013358735, 106.861210833444, 96.4900884548636, 125.012384197517, 107.875653116564, 110.413948380798, 121.527663309949, 107.635679745488, 101.165479809587, 112.195288137393, 125.988202432772, 106.768981042054, 100.750028788064, 98.4401242645706, 102.182815372581, 96.4592501243428, 118.033653873974, 106.357470161916, 135.551344113545, 128.032960202208, 93.376072490288, 101.739109896293, 101.584759986763, 91.3722808818867, 97.579957011562, 89.9497518036598, 91.8411319680904, 118.014976981527, 79.7682966483762, 112.213342756959, 85.2909316042627, 101.929941336894, 132.195377526421, 93.0308692012227, 112.290820019828, 101.947674809563, 118.895040630561, 100.836246685112, 98.5134938686542, 107.898030387211, 90.6388743268494, 90.2288732431459, 103.502834277313, 101.756279740861, 113.515244773959, 80.602356671449, 109.962778874254, 78.9479204583691, 119.809184395766, 107.267535352831, 91.6538186212399, 104.660727619, 85.8427267499681, 102.504930966997, 97.9686216865568, 95.4470685171669, 136.129896972988, 75.0532397244008, 116.453705846408, 109.999155500089, 95.1276062940159, 98.2447384116526, 115.615025714477, 110.769618172151, 87.3330831764363, 88.6990856154975, 99.1031018799394, 112.489449679815, 88.5782680126558, 106.935601861097, 103.100798143861, 113.776832843416, 79.7948797883857, 100.631349232578, 94.4576795900552, 92.9988456487226, 101.796589239099, 98.9486813546421, 97.3702710474591, 101.696562438334, 107.954845520862, 97.0348960266445, 105.268052367942, 89.6843076331008, 127.044552773925, 101.300300209452, 114.549662808716, 111.568722900397, 105.813445210403, 87.0121131996623, 78.7051394768479, 123.62061232012, 132.790075912392, 94.1199635849249, 80.9137879165414, 101.100401030127, 126.744643813026, 114.513863974278, 98.8379898512293, 122.285921475865, 82.0174332731411, 121.248758299393, 129.113538344238, 133.915165339839, 99.4648248180638, 129.129256343022, 84.2863314072524, 86.861377989021, 100.323488005884, 99.454334102454, 105.727990490317, 98.620418404153, 112.562806293534, 101.589924345955, 81.0100578069535, 97.7830148109388, 105.774730858456, 90.8972804816027, 89.4551165615345, 84.0698825918368, 92.9975084775082, 98.4770785896217, 105.322267859768, 124.360627462309, 91.7281904252691, 102.269000231576, 119.530428393222, 121.066078618385, 90.0686349504278, 94.7683732642493, 114.440254224642, 105.418114724794, 122.946538359444, 95.7210017540669, 125.977089177271, 116.540348509169, 80.9376724482223, 153.928844284297, 114.434225922202, 104.563134462785, 106.46007217558, 102.412545641737, 108.377306474091, 103.535195901287, 81.2035136728815, 121.74763348689, 134.736934983898, 141.006471672783, 94.4158557558442, 113.24676812351, 121.919355983674, 92.1968868393244, 114.859274172495, 102.485935170701, 105.760795620076, 110.954178358552, 99.2264185188749, 110.192024252066, 99.0424750467696, 84.3548827889575, 118.633807110414, 97.4587166576275, 102.178012088314, 106.589713928321, 98.5962921995723, 106.068216888201, 119.252369407972, 95.2729583824177, 102.9124794084, 88.8681969007952, 80.4790761151474, 94.0738256599194, 118.698621134118, 71.0246326591078, 91.0508955206512, 132.87802406608, 84.106841434775, 106.84841392388, 115.15016627348, 122.074817965383, 114.531878270508, 126.21850354207, 90.0550560586162, 109.047336138942, 116.193180712073, 89.5537020284768, 121.477793296442, 86.4419346867136, 96.1375007604645, 110.182609744552, 108.661743099899, 101.547888301146, 100.524890364498, 108.233317946735, 133.668869314539, 104.022690755805, 87.0561670940305, 95.4030861408827, 104.578950929061, 108.434212094502, 94.947333065027, 95.325359471427, 94.2275221165331, 114.477734800689, 92.3341210604957, 110.944751762431, 112.947772178405, 92.7054099663105, 93.6297536378105, 100.387078521684, 97.1233309232409, 85.6729091012337, 91.0228569599853, 114.884810414701, 81.8237707418506, 92.3026256400973, 81.5066725273892, 94.1253078994775, 114.208732339382, 106.058395569344, 84.9431765579968, 109.767494658709, 97.861477550108, 107.966270147581, 103.075489852245, 119.650201136865, 138.799716077845, 112.071320184104, 98.0131806203543, 79.763892492862, 120.079545001797, 71.8397132858928, 128.524474119826, 98.7124772416192, 103.564819102141, 111.297716706913, 94.2653740435824, 110.639336743381, 102.630813657944, 113.426728128532, 80.5821528679726, 116.791193703102, 85.9603129347604, 116.838215722127, 114.682703539138, 123.806304178513, 111.124509004681, 136.292306882841, 108.73895940712, 129.949069834761, 93.2254379017045, 107.77937773492, 108.392077937316, 96.2910679828799, 93.1679833627777, 86.4700782308038, 89.5928626598771, 137.192483160559, 100.134290801299, 86.9653303445765, 127.836774769452, 97.4303331379, 100.475923326593, 128.814397625442, 108.612663941873, 115.895297878865, 88.0543816153209, 117.865834973158, 132.647520251164, 104.103100092885, 104.435833218303, 98.1409236379961, 96.6096824119345, 89.4999323473575, 95.9001594935015, 120.892407427427, 100.134690241823, 104.993183777186, 112.028924045539, 80.0727317782651, 103.928945504561, 94.9824947216114, 116.068464451912, 91.5562780649297, 111.511507440815, 84.7768778778943, 117.12705762376, 100.039058543625, 98.460186227917, 104.438077543345, 118.299298810367, 114.615970397999, 104.184949603334, 146.132669435335, 99.9946359181231, 97.2534663335226, 84.0319567971879, 119.845931186177, 116.125335151058, 94.6816717075592, 92.051018113366, 73.4627179086088, 101.059958190254, 81.0216920353223, 98.6719268527945, 143.383558285787, 91.8998609515143, 98.933654663077, 118.114579544676, 96.1540232514274, 127.806638566602, 98.794505032814, 84.8997421955653, 119.474804960962, 105.743499704027, 88.8322358607003, 94.2144155167886, 136.566164283571, 101.252316910153, 127.894362916348, 97.2891487511366, 81.2102430550471, 92.8318932988272, 84.716747531516, 116.952787201748, 110.19545713131, 91.7665768924338, 77.1702751503815, 92.5901267266374, 92.3151106770665, 106.037383517143, 93.4995514917616, 102.644839377307, 96.9238088749074, 87.3562415036683, 96.0874295713456, 113.41794666301, 113.178599354964, 97.6163879192264, 107.60901906851, 107.476049191188, 116.117915001724, 104.138540568765, 81.8169681912749, 73.3455638388847, 79.6730812127278, 106.283661325464, 89.3898430188436, 101.350289528321, 106.7225346239, 89.0311870121215, 87.9245688682026, 108.756530697056, 127.977096350321, 116.944850219244, 84.9691461183406, 119.597591960775, 105.549608317722, 98.2535690741805, 109.281668737037, 94.7014751815486, 96.6614168631735, 109.250859185729, 100.116631231229, 75.2595184472121, 100.720736241807, 110.608888854145, 84.0943874378025, 104.751414136997, 82.9830239827599, 86.3734980793608, 100.297228894018, 100.482923043391, 99.2592170024675, 122.709278604551, 92.439257087718, 94.4673576350072, 93.4858951182613, 119.738120878424, 102.07650073635, 104.446384762762, 99.5938982348135, 105.97824438119, 112.871197397197, 98.6763167594161, 101.234292527347, 96.6265848418907, 97.077195639039, 139.822274804545, 103.405761611534, 96.7119562086219, 112.144205407421, 109.839850674319, 113.57790413232, 104.535449445103, 81.7932477985709, 103.831392636875, 87.1019406867004, 96.2826236373745, 106.70027096551, 112.145676323683, 79.4130460863057, 88.5538168537927, 111.343289967112, 110.609055467924, 94.1605434989896, 104.374201539457, 106.475642931445, 81.4355883666673, 114.227176853255, 92.3657846884428, 98.6644735742234, 102.64099406464, 115.94064384498, 147.648078375412, 76.5225605890695, 80.0621049478925, 87.2595409782818, 129.5943191913, 111.707646405697, 111.112339969904, 125.866815008556, 79.6239884496184, 105.234747545748, 114.797741134256, 106.909407775075, 74.1864174296769, 72.6415724685178, 92.1816335684791, 117.072040011474, 95.8718103063009, 111.091601871754, 97.1984808487109, 99.160728858178, 134.84418944308, 102.235913113706, 84.9469696129035, 92.7569239409553, 119.788244757186, 102.323320364165, 123.311565627389, 124.785324624171, 100.024757965656, 89.4106631380266, 143.093504282233, 89.6029146722898, 98.0767615995778, 91.6822430767299, 93.7390722434469, 94.0613762715579, 100.877324242519, 101.207072348676, 95.318859247285, 114.671787685217, 117.359673089168, 77.4823538664394, 86.4276174086489, 106.540403162598, 106.290239874689, 92.2543050021254, 90.0383404052609, 104.403363561452, 93.7450018061461, 104.47156171475, 95.9542657519076, 105.994582310986, 115.410651705341, 134.84042689845, 94.7479215735913, 104.188423738191, 89.06980655044, 131.250714417997, 96.3629267108049, 142.678653648337, 106.411499259997, 128.317807538737, 114.301877435888, 139.590865464257, 93.3847404383751, 127.363003064812, 92.0392982012062, 101.313834719393, 107.204882005256, 104.042727597224, 109.571748942308, 99.8511989421133, 101.805177562294, 97.9265293778672, 120.62533948175, 122.794429119883, 114.727344960053, 95.0278395237746, 101.26682401833, 112.726847716002, 102.604101566525, 104.664044910579, 83.0732187023269, 77.166318678173, 105.388073407847, 108.713469814696, 110.240297065411, 101.907774496526, 91.6327882697238, 100.317620994919, 107.234163738711, 99.3693548043756, 102.946845838971, 116.066899296462, 101.619025978551, 89.419261374797, 104.163844054099, 109.418286118445, 122.17391253782, 117.381450455831, 96.3269090057357, 91.03254797075, 135.011272617311, 128.096111547642, 96.7383798063319, 110.753936274098, 87.4287566474557, 120.321786371342, 80.5091830832088, 98.7650716024849, 123.038094948715, 113.285106280929, 148.738204851958, 103.755778888656, 99.0830236582616, 107.51779852196, 120.039871804622, 110.334861185838, 105.92965608992, 86.9088939664612, 119.094446489785, 99.1202959429567, 108.851495728795, 95.4450341484266, 116.073691705505, 124.598171541365, 101.398099284555, 85.1242891046078, 90.6942243241533, 111.097477925653, 114.048823677257, 102.50308165162, 90.4983158152871, 133.300062402461, 93.065563636421, 92.1957530449552, 95.2091203289892, 84.6466245021459, 80.7873370974362, 91.6859853483017, 96.6247887089409, 88.9105403239486, 94.2741350170061, 97.3995163796319, 104.793553247766, 81.8925525932444, 95.6924264014715, 88.8474599759329, 105.33586979411, 96.6384787879185, 128.286600411461, 105.378638208, 103.912326631749, 108.334502483383, 84.4852301329602, 90.6372755324229, 93.457642075695, 118.210604048221, 96.8250451799518, 90.1533709926119, 82.7742623520202, 102.594175425255, 81.3098835022564, 84.1426694678623, 83.3980964786406, 91.1887249504267, 119.099290210721, 120.132074473851, 107.714448177527, 111.356409443609, 106.737189486714, 141.870416236181, 117.612578124386, 89.5470282104544, 112.439354586106, 92.0858380224575, 86.2490641365865, 110.528994894882, 92.2755309670634, 102.431466234249, 99.2582824078818, 84.0090956692692, 103.614146945206, 106.885192180034, 103.966967311758, 86.7643443508624, 121.25761196222, 93.6804504443431, 98.7195083649211, 132.328117859429, 108.711745871101, 95.2084933955331, 111.270416352691, 110.842692255883, 100.43596785556, 84.2866096798715, 98.7372921963008, 85.0569689299288};	
	/** The number of samples in the cached library of chi-squared values */
	protected static int samps_chi_sq_df_eq_nu_plus_n_length = 1000;
	/** A cached library of standard normal values (used for Gibbs sampling the posterior means of the terminal nodes) */
	protected static double[] samps_std_normal = {1.68735314817084, -0.444910557777602, -1.01574644305095, -1.23529972526312, 1.66505950389773, -0.217347016602924, 0.202897497145805, -1.15277675955004, 1.45343897213435, -2.02788640308338, -0.267236460158298, 1.0795523009817, -0.353039864994548, -0.511976517819192, 0.0324167140906128, -0.762246720528266, -0.186211494919961, 1.71878199153221, 1.07619487325387, -0.46036995494867, 2.63221455291021, -1.20198317240418, -1.18674454708379, 0.729933779624093, 2.32535852625195, -1.51125550382843, 0.261090225524387, -1.02813430298972, 0.130034420827244, 1.22040694501122, 0.232628439306083, -1.15599917488998, -1.72166239870019, -0.326349967965231, -0.164219002684718, 0.211424912857625, -0.677145955353026, -0.464869099711132, 1.08725089469464, -0.938899758281471, -0.0657625075052816, 0.428909340491499, 1.00486897712219, 0.240646131044336, -0.654404103575109, -0.695284333779822, 0.0464980885562565, -1.29531486610627, -1.60659029848232, -1.60621975588351, -1.65880837365252, -1.35264621245114, 0.610854607139223, -0.134975416651234, -0.827800264615576, -0.382044254119908, -1.67886724466066, 0.114104242463861, -0.365660239645388, 1.6586229449491, 0.564957317424773, -0.28751231676147, 1.37783110372125, -0.861637738544114, -0.247050507313549, 0.386618463593006, 0.268412881797876, 0.864790754792591, -1.04934032122019, -0.567135694695352, -0.60639619137776, 0.285961923946727, 2.52009744583603, -0.995458790026452, -0.0486865807224736, 0.667260291418298, 0.728881949800404, 0.600086707444693, -1.10771969560669, -0.7246165117638, -0.605652988673694, -0.723536343625817, -1.51554709283401, 0.0153640779419458, 0.906492357582404, 1.53127269129535, 1.15714054214229, -0.884012283212003, -0.764887017893891, -0.912065945396406, 0.701267662683593, -0.726283742093813, -0.126267972169618, -0.598813896702432, -0.163845551202672, -0.927013462714506, 1.57372805724866, 0.740753971062386, 1.18525803071727, -1.60421906260442, 1.79917385247218, 0.0605436754224443, -0.655224036711219, 0.477210349259086, 0.239030434410522, -1.68307018931784, 0.180486593866061, -0.000880037786394478, -0.657181144885182, -0.0515470775131718, 0.0442176703394913, -0.109990897837859, 0.538855025867814, -0.820717360331034, -0.98964275356069, -0.47474325360282, -1.1443236478467, 1.04541787535022, 1.05213799847619, -0.0868206312805969, 0.0282276877166018, -0.548056332805544, 0.0280805931815228, 0.691980380628971, -0.553226185169585, -0.540479703000529, 0.736840784612928, 0.817883135506739, 0.448027912893909, 0.0458201770141353, -0.199469243674512, -0.371206082295428, 0.533226573931738, -0.978568711319853, 1.48386276303294, -0.541050453615206, -2.40769560689326, 0.313697309383881, -0.494102213785987, -0.454801330721508, -0.989391819779931, -1.79846716038626, -0.547445072642582, 0.49363455397508, 0.45766454924536, -0.0157824190214411, -0.261836226678728, 1.01986160807483, -0.165274988888192, -0.767469158366734, 0.0324215177646984, -0.285287123217708, -0.981972789823996, 0.10191313595098, -0.0479741105148136, -0.364041369094426, -0.64615119979214, -1.78490776981152, 0.191196729005396, 0.391133469791229, -0.127409250846086, -0.679195368845398, 1.31208111467078, 0.0638999390734125, -0.498498891031731, -0.00603546722675072, -1.23468715133413, -1.22281992106542, -1.44618046898492, -0.507311438636604, 0.73687732580877, -0.370319630147931, 0.583355355478584, -0.338069292048135, -1.08582221563277, 1.69488948384401, -0.0678176142904881, 0.084208434839099, 0.270405361830902, -0.345357274322275, -0.483553773680941, 0.372249127241899, -0.181021415648216, -1.69854019298107, 1.42201099577635, -1.02486336532005, -0.0739797973227061, 0.0747366495921378, -1.35613926289001, 0.130055652810493, 0.0328627362337665, -0.654061336588313, 1.34633270212852, 0.515016685768186, 0.648230723379423, -1.1226446820052, 0.472047488366009, 1.27043389553993, -0.178617011513737, -1.01443918059332, 0.108956270682212, 0.323452188534886, -0.589138764436758, -0.302512377238119, 1.69365985174245, 0.134021398485524, -0.628049595857574, -0.217967317157526, -1.06954227692139, -0.658411125616374, 1.48055129957949, 0.46385758723612, -1.12151921464456, 1.01253668581507, 0.788403114193161, 0.88708663379775, -1.50419538248464, 1.67951640381625, -0.988036020657836, -0.80571891989692, 0.010475096513439, 0.50336436748765, 0.528476114457015, -0.595328527276442, -0.188035816516277, 1.19310710461377, -0.709433444199444, 1.47062071846226, -0.617201223072023, 0.322773683189391, 0.681277155159144, -0.201069631556465, 2.11900065223911, -0.615509137982473, 0.604155107352231, -1.47305315007424, -0.589442432036494, -0.553997831818672, -0.205425713895076, 0.939811873164624, -0.219050221598709, 1.7105530620785, -1.40514744568316, 0.375808924667616, 1.21146579191576, -0.882207340690433, 0.123452086818663, -0.502790288685832, 0.293732963151202, -0.87276371890189, -1.38964213678777, 1.0765205127353, -0.668357605836804, -2.00112564151562, -0.632295098109308, 0.145078130053206, -1.09035760311003, 0.935187389657185, 3.5166502810062, -1.00290347826468, -0.390259502991752, -0.593337148962085, 0.245632388787966, 0.876065828552118, -1.05825417719608, 0.595687534971721, -0.197639775949171, 2.85620188111623, -0.245086749661611, -0.383380962559251, -0.455030739677492, 0.852510360718742, -0.521972066456059, -0.531548753676128, 1.08905057472387, 1.29328077273319, -0.148791168760444, -1.02713874300718, -1.50173736422572, 0.0605465403405431, -0.897901056098128, 0.175865036382552, -2.25818911630684, 0.636921861433502, -1.87824512420509, 0.721465564738846, 0.517243880270693, 1.06903155655321, -0.0139929290044932, -0.103980964134874, -0.712571692354049, 2.27551008849665, 0.875456117279408, 0.747068984205433, -1.33361545606961, 0.572364271948511, 0.595040344466473, 0.0565334046555808, -1.21985307591964, 0.223101660265357, -0.559318582066793, -1.11187843552702, -0.42092020414504, -0.163920323504733, 1.27773200115194, -0.518757583188076, 0.371010824717897, -0.736908143793174, -0.402917353465649, -1.59629240259608, 0.183085955668653, -0.375768044033167, 0.781777871894688, -0.303115168391483, 0.0423654081636594, -0.886422596411879, 0.212423094728782, 0.0828794571570571, 0.91909190474418, 0.16257198947094, -0.269804842366689, 1.56399370219186, 0.00242883399086761, -0.0085032045337028, 2.85246294204887, -0.280980486926061, -0.811886548838849, -0.262347648463121, -1.89269655617187, 1.05935733286268, -0.258683368385211, 0.332918669411464, 0.113980396662717, -1.09050699402331, 0.477067138128562, -0.287100482391397, 0.748449498131305, -0.383253927036543, 1.54952995260704, -1.23000378439822, 0.871957094083811, -0.527946896451088, -1.33416333250679, -1.56772421188695, 1.98341737132481, 0.642557956028257, -0.983129938472842, -0.0307117501719833, -0.798526769523682, -1.24906595178462, 1.00894212642036, -0.0847759183993153, -0.543574173498525, 0.631089107242137, 1.12454490405699, -0.875250073675429, -0.377721650108984, -0.306814645861413, 1.81902506716217, -0.611806812780607, 1.54720937068998, 1.1531525374595, 0.961776625736216, -0.782134069577865, -0.135305744495071, -0.149204743389108, -0.210388961133886, -0.807520143793284, -0.11946814225897, -0.321076226227115, 0.260279715071925, -0.525188708922196, 0.879420395433948, 0.40150714444431, -0.913298377988331, 0.00814511210136953, -1.57171191294679, -0.866783734591104, -0.231535886286616, -1.15605964448995, 1.03276894129727, -0.560434223165741, 0.765893738057223, 1.13383413712434, 1.42321339927086, -1.05440261993384, -0.721680582588624, 2.36846327783637, -1.1963994877938, 0.735794134853658, 2.07152091420206, 0.34230841093649, -0.602301931718463, -0.361118484436775, 0.91984236079989, -0.467807974782495, -0.187639121190767, -0.868562270877314, 1.28098677103503, -0.123677827046468, 0.881892739819439, -2.7469690681395, -0.187924798642913, -0.756544897189139, -2.02306167412184, -1.6839541717365, 0.57609158260397, 0.705653986323556, 0.30434360885245, 0.0142379840110398, 1.23730243982528, -0.592992664019526, 0.76681547380466, 1.43000463410148, 0.498267551173462, -1.30117734510301, -0.275972733805002, 0.6421638926601, 1.98508628640271, -0.495256264862567, -1.89499862350925, 0.46105838445666, 1.64452976849979, -0.83772958451588, -0.314962168479717, 0.406996326352449, 0.988762064560367, 0.893640471918567, -0.060132268759968, 0.797470840936751, -0.478259671551361, -0.970786036958277, -0.408511774719201, -1.67264434154929, 0.95391957950955, -0.822653270861047, -1.19303680395676, 1.30196210163741, -0.156303815500192, -0.785163658324787, 0.805975079265687, -1.3765257736002, -1.53698355895264, -1.40118327657908, -0.577167444587661, 1.41834387919141, -0.838131276651258, -0.0381389020567237, -0.8498579962961, 2.11298636121118, 1.26888384760506, 1.59395071738851, -0.668746334593958, -0.583475659213315, -1.064709699548, -0.907832766682632, 3.09836781153805, -1.11726332522263, 0.128100396793381, 1.25128442945845, -0.334311110185929, 0.775496650482245, 0.145892526940115, 1.51389521325315, -0.179412203982341, 1.33678826662615, 0.70925835229209, -0.00377663101447018, -0.32615464999356, -1.21043588650023, 0.233542212820561, -0.380984190310182, 0.621664622516034, -0.110702659125204, 0.148166074297944, -0.460075322889873, -0.890828708644614, -1.02074236258281, 0.153624974407052, 1.2915117967028, -0.0549953093670552, -0.484517180573288, 0.404030697762505, 1.39004826165286, -0.592717258867787, 1.38687013255084, 0.624690883946397, 0.645845955000952, 1.22994166693548, 0.317372446858872, 1.17038896143217, 0.230309108182562, 0.94618449022311, -0.911927040004271, 0.79792754135142, -1.08439612185251, -1.48103952022006, 0.617572817054316, 1.22496340400966, 0.0851890788933952, -0.379349565336826, -0.846444255816211, -0.180138641271461, 0.198374407919941, -0.720392548689354, 0.985204937261997, -2.18348082255539, 0.685154691873701, 0.315407594836271, -0.558989106397838, -0.674299290386468, 0.156491592243344, 1.52630153304585, 0.846464105722962, 0.934610277911744, 0.686275503893869, -0.944648763623139, 1.3925899112709, -0.605278919799188, 0.774467956414185, 0.428400067704701, 2.68475879580067, 0.784461823234396, 1.10234799800916, 1.54739804461409, -0.718215228905284, -0.630302122560195, -0.934359925146205, 0.303542715789551, -0.293175075844889, -0.298229695690515, -1.30482300143497, -0.480080733009919, -0.825779313174317, 2.31135743852636, -1.52357340305947, -1.64405840520343, 1.68071165219341, 0.0462500800950408, 0.657630115119155, -1.80431107218939, -0.374191675667633, 1.22042710386283, 0.313035390721923, 0.734192150159058, 1.46980654957081, 0.0987402393229203, 0.322167448829319, 0.240131356219157, -0.352954064852596, 0.688315654629946, -0.129425174514192, -1.87042626327216, -0.276341931949997, -0.178754646603177, 0.585034704399849, -0.690673398678924, -0.125019164944318, -1.8753886262818, 0.100685278016874, 1.33538581727619, 0.145230786420073, -1.14953900050547, -0.275362931421276, 1.2893113651037, -0.105194875037359, -0.425048268334579, -0.784153096281819, 1.59338700681888, -0.968516734922509, -3.19449998411996, 0.589082592685992, 0.39095881566061, -1.24973388032279, -0.224638367866996, 0.354543891328227, 0.710618096930302, 0.710207080134041, -0.479427076041401, -1.04825713782729, 0.959075444143674, 1.19895124120085, -0.0143201989543357, 1.2258936595499, -0.627222127394801, 0.990688110510241, 1.73526567825401, 1.31483471438897, -1.73969850369556, -0.659153115413141, 1.03948998478571, -0.312583181579645, -1.29593458207878, -0.905966795204727, -0.305386259464374, -2.02032484435611, 0.176374285602108, -0.948981392015035, -1.28378294546401, -1.14430180372312, 1.28796391100975, -1.55481880270947, 0.295635349079617, -1.22936759633331, -0.17908989794121, -0.0844741616189034, -0.274367416675028, 0.36855208720033, 0.398465620995993, -0.239315095490773, 0.807621874151524, 0.264422386724209, -1.52357924503549, 1.27711276621762, -1.21597115954019, -1.23408663253487, -0.544658638923835, 1.43099034459663, -1.16777069034934, -0.71580489679377, 1.83033611229891, -1.89427799038218, 0.359735244878567, 0.864486526197775, -0.0420655736767464, -1.23072404461989, -1.03215741381239, 0.574937652580627, 0.636737465686644, -0.893768087545503, -0.0242230067866355, 0.778775716857437, -0.414326481350278, -1.06441270517089, 0.924333823768664, -1.61597463209243, -0.0746376072910136, 0.0218859449890031, 0.82891153700138, 0.925179040301985, 0.252753008238279, -0.258779326216691, -1.61634855145405, -1.49722222515794, -1.13322081926657, 1.22829006669937, -1.1271943319018, -1.08454993067519, -0.677745898075497, -1.26914221048871, -1.59753666797504, -0.159512638354768, -0.0719155899226276, -1.08534277278442, 0.913976831092412, -0.0397615774226814, -0.103828295575522, -0.657563076260608, 0.591759866044731, 0.585165097517722, -0.239630817236287, 0.692918811043202, 1.76429799823862, -0.166403421368371, 1.48937510791418, 0.568868491173289, 0.345634896138494, -0.493405096226176, -1.32575703736559, -0.51756133118327, 0.67634036052087, -0.839301113357522, 1.2713421990097, 0.241348636539026, -3.68785439059885, 2.21594576431351, -1.46372646927011, -0.185968018131275, 0.247028697219919, -0.036348936694783, -0.80623084464792, -0.428947589590481, 0.823971048813832, 0.20261750836091, -0.888571593383334, -0.467952757570228, -0.462793680040876, -0.788856914741067, 1.34305676561296, 1.31347990773807, -0.752464543590909, -0.536739404194182, -0.677009008959236, -0.937812301557162, -0.423493697910085, 0.485890177964632, -0.217948955210801, 0.644775112836099, -1.53260748072646, -0.778705940658963, 0.155838342570639, -0.524277273979183, 0.334528044073346, -2.21407954371816, 1.07877213618902, 1.61804339256404, 0.286985776813829, 0.721095109387764, 0.204529447072239, 0.133206381172506, 0.878223148291148, 0.157251218982125, -1.22363404875235, 0.206744403415515, 1.51043720807135, 0.0190529292578991, -0.878579846309318, 0.973073845232868, 1.049218161429, -0.26700939710261, 0.756423491131752, 0.046403436286077, -0.486450209932419, 0.255507971176291, -0.470965489224083, 0.00861904846197636, 0.518657844095602, 1.79634139666502, -0.132647097276783, 1.25438174410812, 0.753425531594117, 0.693300687571491, 0.197313456333741, -0.605906098276346, 0.376443614295213, 0.753919872669219, -2.07634331831506, -0.587042932100447, 0.714549499607564, 0.895292360531685, 1.10965965378921, -0.230851828587151, -0.587239111684277, -0.671923007436761, 0.703634871989605, 0.679667042834558, -1.4740034934737, -1.2783378713096, 2.10351251749179, -1.43995070331185, 1.0864685333642, 0.353159604197382, -0.20488090475467, 1.08228807178819, -1.00064684388014, -0.357625379780522, -1.00670788912698, -0.205859678810939, 0.887322371515227, 1.00270778400067, -0.573257904582501, -1.4683905226244, 0.753103836310855, -0.935148075284692, -0.601553791373255, 0.757734456454978, 0.689866057509446, 0.32592602084167, 1.53852738415177, 0.0962068129574443, -0.723384556808773, 0.531642050055789, -0.668722076016437, 0.244142026917636, -0.779432996462019, -1.16304113069173, -1.55071478743162, 1.46168521681828, 1.34592887273953, -0.842738311854484, -0.428818694016823, 1.02569998081276, -1.10605196879664, 1.10198645092665, 1.42513727575678, 0.53589236554719, 1.00307906151453, 1.03599274429821, 3.21732534347306, 0.458551785979854, 0.0508729585991429, 0.762652382481703, 0.579874457777816, 0.927687214721911, 0.516876220384116, 1.18655263846738, -1.08549043454121, -0.159201052264869, 0.28206528022585, -1.47070000965601, 1.62204960978516, 0.54366939777309, 1.03132713431855, -2.10318556322841, 0.972612403282934, 1.68254202516764, -0.237393397109801, -0.731773532397605, -0.341072308437966, -1.18432028763883, -1.6299395521426, 0.0099336076073523, 0.713438669371145, -0.33950423611388, -2.30179024363372, -0.611739583401703, -3.11068649550846, 0.0126474207119549, -1.11673094510596, 0.807050614899971, 0.170494688201089, -0.637037594658805, -0.186570598156716, -1.67113753156649, -0.497927047747853, -0.318157541188721, 0.920717466784368, 0.592745046772766, -0.0189273506575972, 0.0821090906654834, 1.15860958348221, 0.231255401239555, -0.0357413071105929, -0.737585754985121, 1.45586902845132, -0.559852547153121, -0.55202721722964, 0.927949113887658, -0.214756466707769, 0.480978443877601, -1.1583385569666, -0.549580232607457, -0.549518274500649, 0.24132051109758, 1.09156883897745, 2.8332795664951, 0.728833688382595, -0.0119398048996323, 0.254287500722409, 0.0627581213445264, -0.109807355833478, -1.21550720569358, -0.425224369656312, -1.35893250464367, -0.449721737748941, -1.21985283073164, 1.00917770863965, 0.23220358463632, 0.366016253551683, -1.07615409314515, 1.51336775698844, 0.497866063497182, -0.0101169051549631, -1.58510578545623, 2.06064436935077, 0.868164280130582, -0.243493625207376, -0.162665163232432, 0.459884878211912, 0.982731466635455, 1.80181784040222, -0.845320092614703, 0.328661187930586, -0.0378888696189792, 0.167856037211757, 0.495943979702333, -0.233049604233485, -0.347524560606795, 0.807085956159625, -0.861853380839786, -0.937339016810423, 2.02275748710565, -1.48980007949269, 0.916913287887501, -0.610928548401561, 1.18691671261507, 1.65539395387344, -1.10678983153521, 1.23368898358904, -0.40642271452782, 1.66464462465117, 0.556616453393299, -0.656804771704099, 0.786525096842244, 0.546639299053528, 1.60101574790266, -0.0189930406843498, -2.33183893282302, -0.064183803077976, -0.0716588382973201, 1.56786843469315, -0.768490834659959, 1.50251316861945, 1.02803875268925, -0.176347459333253, 0.436980583032935, 1.1798949847216, -1.42657854489542, 1.68875082599775, -0.476042541390408, 0.248251380350038, -0.74735967899607, 1.30807016099901, -1.31529513146544, 1.30202285934235, 0.221711447296159, -0.668122591507492, 1.07083687201453, 1.6180098653389, -0.071312313728832, -0.9298123577823, -1.94323035444819, -1.14933731500613, 0.990922950769031, -0.667802146572849, -1.5762466419425, -0.290271955508946, 0.669922280272166, -0.132903386463191, 1.18581867866334, 2.00587824087804, -0.988605019050622, 0.109749575456403, 0.762782222450985, 0.558975550668302, -0.396872341322575, -2.53050756743326, 0.629808573268617, 0.927722095641719, -1.00591272320778, 1.43619393576094, -0.108877947187792, 0.175320165888563, -0.960379153790069, -0.153513334970004, -1.25204705485406, 0.110690344691871, -1.85804858580497, 0.0197582024748512, -0.549101226424596, 0.471019304819184, 0.430484018040887, -1.35686754101772, 0.38571250890353, 0.340831709566483, 0.324994818647284, -0.317894847546759, -0.704159849003376, 1.79623220769393, 0.41381132119729, -0.119558541225585, 1.68369606759552, -0.834903350634387, 0.595151320808991, 0.387586467103538, 1.21911880068817, -1.71783987781604, -0.586187169795073, 0.583425757787186, -0.481195228802415, -0.14737565482379, -2.18950653957228, -1.07014548451201, 0.23539366844849, -0.141694938026064, -0.281500211884372, 1.0782300512054, 0.0327930260281479, 1.44082532294668, -0.434265289426712, -0.0991358488486809, 0.645742929868418, 1.00023755141482, -0.345301026432564, 0.262885484125625, -0.372293374675252, 0.135322472724731, 0.445000462292225, 0.39011877801886, 0.068866981444856, -0.509713650597625, 1.53375711687784, 1.11841397436893, 0.0782375509983361, -0.760807840553138, -0.331825681565317, -0.898211919725003, 0.95443527232635, -0.679058725564729, 0.96216569317776};
	/** The number of samples in the cached library of standard normal values */
	protected static int samps_std_normal_length = 1000;
	
	/** the center of the prior of the terminal node prediction distribution */
	protected double hyper_mu_mu;
	/** the variance of the prior of the terminal node prediction distribution */
	protected double hyper_sigsq_mu;
	/** half the shape parameter and half the multiplicand of the scale parameter of the inverse gamma prior on the variance */
	protected double hyper_nu = 3.0;
	/** the multiplier of the scale parameter of the inverse gamma prior on the variance */
	protected double hyper_lambda;
	/** this controls where to set <code>hyper_sigsq_mu</code> by forcing the variance to be this number of standard deviations on the normal CDF */
	protected double hyper_k = 2.0;
	/** At a fixed <code>hyper_nu</code>, this controls where to set <code>hyper_lambda</code> by forcing q proportion to be at that value in the inverse gamma CDF */
	protected double hyper_q = 0.9;
		
	/** A hyperparameter that controls how easy it is to grow new nodes in a tree independent of depth */
	protected double alpha = 0.95;
	/** A hyperparameter that controls how easy it is to grow new nodes in a tree dependent on depth which makes it more difficult as the tree gets deeper */
	protected double beta = 2;
	/** the minimum of the response variable on its original scale */
	protected double y_min;
	/** the maximum of the response variable on its original scale */
	protected double y_max;
	/** the minimum of the response variable on its original scale */
	protected double y_range_sq;
	/** the sample variance of the response variable on its original scale */
	protected Double sample_var_y;
		
	/** A wrapper to set data which also calculates hyperparameters and statistics about the repsonse variable */
	public void setData(ArrayList<double[]> X_y){
		super.setData(X_y);
		calculateHyperparameters();	
	}
	
	/** Computes <code>hyper_sigsq_mu</code> and <code>hyper_lambda</code>. */
	protected void calculateHyperparameters() {
		hyper_mu_mu = 0;
		hyper_sigsq_mu = Math.pow(YminAndYmaxHalfDiff / (hyper_k * Math.sqrt(num_trees)), 2);
		
		if (sample_var_y == null){
			sample_var_y = StatToolbox.sample_variance(y_trans);
		}

		//calculate lambda from q
		double ten_pctile_chisq_df_hyper_nu = 0;		
		ChiSquaredDistributionImpl chi_sq_dist = new ChiSquaredDistributionImpl(hyper_nu);
		try {
			ten_pctile_chisq_df_hyper_nu = chi_sq_dist.inverseCumulativeProbability(1 - hyper_q);
		} catch (MathException e) {
			System.err.println("Could not calculate inverse cum prob density for chi sq df = " + hyper_nu + " with q = " + hyper_q);
			System.exit(0);
		}

		hyper_lambda = ten_pctile_chisq_df_hyper_nu / hyper_nu * sample_var_y;
	}	
	
	/** Computes the transformed y variable using the procedure outlined in the following paper:
	 *  
	 *  @see HA Chipman, EI George, and RE McCulloch. BART: Bayesian Additive Regressive Trees. The Annals of Applied Statistics, 4(1): 266-298, 2010.
	 */
	protected void transformResponseVariable() {
		super.transformResponseVariable();
		y_min = StatToolbox.sample_minimum(y_orig);
		y_max = StatToolbox.sample_maximum(y_orig);
		y_range_sq = Math.pow(y_max - y_min, 2);
	
		for (int i = 0; i < n; i++){
			y_trans[i] = transform_y(y_orig[i]);
		}
	}

	/**
	 * Transforms a response value on the original scale to the transformed scale
	 * 
	 * @param y_i	The original response value
	 * @return		The transformed response value
	 */
	public double transform_y(double y_i){
		return (y_i - y_min) / (y_max - y_min) - YminAndYmaxHalfDiff;
	}
	
	/**
	 * Untransforms a vector of response value on the transformed scale back to the original scale
	 * 
	 * @param yt	The transformed response values
	 * @return		The original response values
	 */
	public double[] un_transform_y(double[] yt){
		double[] y = new double[yt.length];
		for (int i = 0; i < yt.length; i++){
			y[i] = un_transform_y(yt[i]);
		}
		return y;
	}
	
	/**
	 * Untransforms a response value on the transformed scale back to the original scale
	 * 
	 * @param yt_i	The transformed response value
	 * @return		The original response value
	 */
	public double un_transform_y(double yt_i){
		return (yt_i + YminAndYmaxHalfDiff) * (y_max - y_min) + y_min;
	}
	
	/**
	 * Untransforms a response value on the transformed scale back to the original scale
	 * 
	 * @param yt_i	The transformed response value
	 * @return		The original response value
	 */
	public double un_transform_e(double e_i_transformed){
		return e_i_transformed * (y_max - y_min);
	}	
	
	/**
	 * Untransforms a response value on the transformed scale back to the original scale
	 * 
	 * @param yt_i	The transformed response value
	 * @return		The original response value
	 */
	public double un_transform_y(Double yt_i){
		if (yt_i == null){
			return -9999999;
		}
		return un_transform_y((double)yt_i);
	}	
	
	/**
	 * Untransforms a variance value on the transformed scale back to the original scale
	 * 
	 * @param sigsq_t_i		The transformed variance value
	 * @return				The original variance value
	 */
	public double un_transform_sigsq(double sigsq_t_i){
		//Based on the following elementary calculation: 
		//Var[y^t] = Var[y / R_y] = 1/R_y^2 Var[y]
		return sigsq_t_i * y_range_sq;
	}
	
	/**
	 * Transforms a variance value on the original scale to the transformed scale
	 * 
	 * @param sigsq_t_i		The original variance value
	 * @return				The transformed variance value
	 */
	public double transform_sigsq(double sigsq_t_i){
        return sigsq_t_i / y_range_sq;
	} 
	
	/**
	 * Untransforms many variance values on the transformed scale back to the original scale
	 * 
	 * @param sigsq_t_is	The transformed variance values
	 * @return				The original variance values
	 */
	public double[] un_transform_sigsq(double[] sigsq_t_is){
		double[] sigsq_is = new double[sigsq_t_is.length];
		for (int i = 0; i < sigsq_t_is.length; i++){
			sigsq_is[i] = un_transform_sigsq(sigsq_t_is[i]);
		}
		return sigsq_is;
	}			
	
	/**
	 * Untransforms a response value on the transformed scale back to the original scale and rounds to one decimal digit
	 * 
	 * @param yt_i	The transformed response value
	 * @return		The original response value rounded to one decimal digit
	 */
	public double un_transform_y_and_round(double yt_i){
		return Double.parseDouble(TreeArrayIllustration.one_digit_format.format((yt_i + YminAndYmaxHalfDiff) * (y_max - y_min) + y_min));
	}

	/**
	 * Untransforms many response values on the transformed scale back to the original scale and rounds them to one decimal digit
	 * 
	 * @param yt	The transformed response values
	 * @return		The original response values rounded to one decimal digit
	 */
	public double[] un_transform_y_and_round(double[] yt){
		double[] y = new double[yt.length];
		for (int i = 0; i < yt.length; i++){
			y[i] = un_transform_y_and_round(yt[i]);
		}
		return y;
	}		

	/**
	 * Untransforms many response values on the transformed scale back to the original scale and rounds them to one decimal digit
	 * 
	 * @param yt	The transformed response values
	 * @return		The original response values rounded to one decimal digit
	 */
	public double[] un_transform_y_and_round(TDoubleArrayList yt){
		return un_transform_y_and_round(yt.toArray());
	}	
	
	public void setK(double hyper_k) {
		this.hyper_k = hyper_k;
	}

	public void setQ(double hyper_q) {
		this.hyper_q = hyper_q;
	}

	public void setNu(double hyper_nu) {
		this.hyper_nu = hyper_nu;
	}
		
	public void setAlpha(double alpha){
		this.alpha = alpha;
	}
	
	public void setBeta(double beta){
		this.beta = beta;
	}
	
	public double getHyper_mu_mu() {
		return hyper_mu_mu;
	}

	public double getHyper_sigsq_mu() {
		return hyper_sigsq_mu;
	}

	public double getHyper_nu() {
		return hyper_nu;
	}

	public double getHyper_lambda() {
		return hyper_lambda;
	}

	public double getY_min() {
		return y_min;
	}

	public double getY_max() {
		return y_max;
	}

	public double getY_range_sq() {
		return y_range_sq;
	}
}
